@model IEnumerable<ShiNengShiHui.Web.Models.Teacher.Prize.PrizeResultViewModel>

@section PageSpecificJavascriptIncludes{
    <script type="text/javascript">
        $("#PrizeComput").click(function () {
            $("#PrizeComputForm").submit();
        })

        $("#serchButton").click(function () {
            $("#serchForm").submit();
        })
    </script>
}

<div class="panel">
    <div class="panel-heading">
        <div class="row">
            @using (Html.BeginForm("PrizeComput", "Teacher", FormMethod.Post, new { id = "PrizeComputForm" }))
            {
                @Html.AntiForgeryToken();
                <div class="col-lg-3">
                    @Html.DropDownList("schoolyear", ViewBag.SchoolYearList as List<SelectListItem>, new { @class = "form-control" })
                </div>

                <div class="col-lg-2">
                    @Html.DropDownList("semester", ViewBag.SemesterList as List<SelectListItem>, new { @class = "form-control" })
                </div>

                <div class="col-lg-2">
                    @Html.DropDownList("week", ViewBag.WeekList as List<SelectListItem>, new { @class = "form-control" })
                </div>
                <div class="col-lg-2">
                    @Html.DropDownList("computSelect", ViewBag.ComputSelect as List<SelectListItem>, new { @class = "form-control", id = "ComputSelect" })
                </div>
                <a class="btn btn-primary" id="PrizeComput" title='计算成绩' href="javascript:;"><i class="fa fa-calendar" aria-hidden="true"></i> 计算成绩</a>
            }
        </div>
        
        <br/>

        <div class="row">
            @using (Html.BeginForm(null, null, FormMethod.Get, new { id = "serchForm" }))
            {
                @Html.AntiForgeryToken()

                <div class="col-lg-3">
                    @Html.DropDownList("schoolyear", ViewBag.SchoolYearList as List<SelectListItem>, new { @class = "form-control" })
                </div>

                <div class="col-lg-2">
                    @Html.DropDownList("semester", ViewBag.SemesterList as List<SelectListItem>, new { @class = "form-control" })
                </div>

                <div class="col-lg-2">
                    @Html.DropDownList("week", ViewBag.WeekList as List<SelectListItem>, new { @class = "form-control" })
                </div>

                <div class="col-lg-2">
                    @Html.DropDownList("selectd", ViewBag.SelectList as List<SelectListItem>, new { @class = "form-control" })
                </div>

                <a class="btn btn-info" id="serchButton" href="javascript:;"><i class="fa fa-search"></i>查找</a>
            }
        </div>

    </div>
    <div class="panel-body">
        @if (Model == null)
        {
            <h3>请查询信息</h3>
        }
        else
        {
            <table class="table table-striped table-hover ">
                <thead>
                    <tr>
                        <th>序号</th>
                        <th>姓名</th>
                        <th>获奖名称</th>
                        <th>时间</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        int i = 1;
                        foreach (ShiNengShiHui.Web.Models.Teacher.Prize.PrizeResultViewModel m in Model)
                        {
                            <tr>
                                <td>@i</td>
                                <td>@m.StudentName</td>
                                <td>@m.PrizeName</td>
                                <td>@m.SchoolYearAndMore</td>
                            </tr>
                            i++;
                        }
                    }


                </tbody>
            </table>

                        }

    </div>
</div>

@if (Model == null)
{

}
else
{
    int pageIndex = (int)ViewData["pageIndex"];
    int pageCount = (int)ViewData["pageCount"];

    string selectd = ViewData["selectd"].ToString();
    string schoolyear = ViewData["schoolyear"].ToString();
    string semester = ViewData["semester"].ToString();
    string week = ViewData["week"].ToString();

    <div class="text-right">


        <ul class="pagination">
            <li><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=1,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">首页</a></li>
            @if (pageIndex <= 5)
            {
                for (int i = 1, length = pageCount; i <= length; i++)
                {
                    if (pageIndex == i)
                    {
                        <li class="active"><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                    }
                    else
                    {
                        <li><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                    }
                }
            }
            else
            {
                if (pageIndex >= 3 && pageIndex <= pageCount - 2)
                {
                    for (int i = pageIndex - 2; i < pageIndex + 2; i++)
                    {
                        if (pageIndex == i)
                        {
                            <li class="active"><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                        }
                        else
                        {
                            <li><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                        }
                    }
                }
                else
                {
                    if (pageIndex <= 2)
                    {
                        for (int i = 1; i <= 5; i++)
                        {
                            if (pageIndex == i)
                            {
                                <li class="active"><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                            }
                            else
                            {
                                <li><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                            }
                        }
                    }
                    else
                    {
                        for (int i = pageCount - 4; i <= pageCount; i++)
                        {
                            if (pageIndex == i)
                            {
                                <li class="active"><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                            }
                            else
                            {
                                <li><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=i,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">@i</a></li>
                            }
                        }
                    }
                }
            }
            <li><a href="@Url.Action("PrizeIndex","Teacher",new { pageIndex=pageCount ,selectd=selectd,schoolyear=schoolyear,semester=semester,week=week})">尾页</a></li>
        </ul>
    </div>
}

