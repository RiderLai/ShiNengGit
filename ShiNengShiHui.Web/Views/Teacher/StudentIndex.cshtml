@model IEnumerable<ShiNengShiHui.Web.Models.Teacher.Student.StudentResultViewModel>

@section PageSpecificJavascriptIncludes{

    <script type="text/javascript">
        var sid;


        $("#delete").click(function () {
            var message = "你确定要删除勾选的记录吗?将删除学生所有的信息（包括参与的活动记录），删除后数据将不可恢复！";
            if ($(this).attr("message"))
                message = $(this).attr("message") + "，" + message;
            bootbox.confirm(message, function (result) {
                if (result) {
                    $("#mainForm").submit();
                }
            });
        });

        $("#BatchImportStudents").click(function () {
            $.upload({
                url: '@Url.Action("BatchImportStudents")',
                fileName: 'file',
                dataType: 'json',
                onSend: function () {
                    return true;
                },
                onSubmit: function () {
                    bootbox.alert("请选择导入的Excel表格，导入过程需要较长时间，请耐心等待！");
                },
                onComplate: function (jsdata) {
                    if (jsdata.Statu == "Success") {
                        bootbox.alert(jsdata.Msg, function () {
                            location.reload();
                        });
                    } else {
                        bootbox.alert("导入失败！" + jsdata.Msg);
                    }
                }
            });
        });

    </script>
}

<div class="alert alert-info alert-dismissible" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <i class="fa fa-info-circle"></i> 批量导入功能可以通过Excel表格导入学生信息，为保证系统性能，单次导入学生数量不可超过500人。导入的Excel模板请点击<a class="green" href="@Url.Action("DownInputStudentTemplate")"> 这里下载</a>。
</div>

@using (Html.BeginForm("StudentDelete", "Teacher", FormMethod.Post, new { id = "mainForm" }))
{
    @Html.AntiForgeryToken()

<div class="panel">
    <div class="panel-heading">
        <a class="btn btn-danger" id="delete" href="javascript:;"><i class="fa fa-trash-o"></i> 删除</a>
        <a class="btn btn-success thickbox" title='添加新用户' href="@Url.Action("StudentCreate")?TB_iframe=true&height=450&width=500"><i class="fa fa-plus" aria-hidden="true"></i> 新增</a>
        <a class="btn btn-default" id="BatchImportStudents" href="javascript:;"><i class="fa fa-folder-open" aria-hidden="true"></i> 批量导入</a>
    </div>
    <div class="panel-body">
        <table class="table table-striped table-hover ">

            <thead>
                <tr>
                    <th style="width: 8px;">
                        <input type="checkbox" id="checkall" class="group-checkable" />
                    </th>

                    <th>
                        姓名
                    </th>
                    <th>
                        性别
                    </th>

                    <th>
                        小组
                    </th>
                    <th>
                        操作
                    </th>
                </tr>
            </thead>
            <tbody>
                @if (Model == null)
                {

                }
                else
                {
                    foreach (ShiNengShiHui.Web.Models.Teacher.Student.StudentResultViewModel s in Model)
                    {
                        <tr>
                            <td>
                                <input type="checkbox" class="checkboxes" name='sid' value='@s.Id' />
                            </td>
                            <td>
                                @s.Name
                            </td>
                            @if (s.Sex)
                        {
                                <td>男</td>
                            }
                            else
                            {
                                <td>女</td>
                            }

                            @if (s.Group == null)
                        {
                                <td></td>
                            }
                            else
                            {
                                <td>@s.Group</td>
                            }

                            <td>

                                <a class="btn btn-info thickbox" title='编辑用户资料' href="@Url.Action("StudentEdit", new { id = s.Id })?TB_iframe=true&height=450&width=500">
                                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                    编辑
                                </a>
                            </td>
                        </tr>
                    }
                }
               

            </tbody>
        </table>
    </div>
</div>
}


